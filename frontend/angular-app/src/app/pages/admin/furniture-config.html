<div class="furniture-config" [attr.data-theme]="currentTheme">
  <!-- Header -->
  <header class="config-header">
    <div class="header-content">
      <button 
        class="back-button" 
        (click)="goBack()"
        [attr.aria-label]="'Volver a configuración de rangos'"
        type="button">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        Volver
      </button>
      
      <div class="title-section">
        <h1>Configuración de Mueble</h1>
        <p class="subtitle" *ngIf="formData.nombre">{{ formData.nombre }}</p>
      </div>

      <div class="status-indicators">
        <div class="save-status" [class]="saveMessageType" *ngIf="saveMessage">
          <svg *ngIf="saveMessageType === 'success'" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 6L9 17l-5-5"/>
          </svg>
          <svg *ngIf="saveMessageType === 'error'" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="15" y1="9" x2="9" y2="15"/>
            <line x1="9" y1="9" x2="15" y2="15"/>
          </svg>
          {{ saveMessage }}
        </div>
        
        <div class="changes-indicator" *ngIf="hasUnsavedChanges && !isSaving">
          <span class="dot"></span>
          Cambios sin guardar
        </div>
        
        <div class="saving-indicator" *ngIf="isSaving">
          <div class="spinner"></div>
          Guardando...
        </div>
      </div>
    </div>
  </header>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>Cargando información del mueble...</p>
  </div>

  <!-- Main Form -->
  <main class="config-main" *ngIf="!isLoading">
    <div class="form-container">
      <form class="furniture-form" (ngSubmit)="saveChanges()" #furnitureForm="ngForm">
        
        <!-- Nombre del Mueble -->
        <div class="form-group">
          <label for="nombre" class="form-label">
            Nombre del Mueble
            <span class="required" aria-label="Campo obligatorio">*</span>
          </label>
          <input
            type="text"
            id="nombre"
            name="nombre"
            class="form-input"
            [class.error]="hasFieldError('nombre')"
            [(ngModel)]="formData.nombre"
            (input)="onFieldChange()"
            required
            minlength="2"
            maxlength="100"
            placeholder="Ingrese el nombre del mueble"
            [attr.aria-describedby]="hasFieldError('nombre') ? 'nombre-error' : null"
            autocomplete="off">
          
          <div 
            id="nombre-error" 
            class="error-message" 
            *ngIf="hasFieldError('nombre')"
            role="alert"
            aria-live="polite">
            {{ getFieldError('nombre') }}
          </div>
        </div>

        <!-- Número del Mueble -->
        <div class="form-group">
          <label for="numero" class="form-label">
            Número del Mueble
            <span class="required" aria-label="Campo obligatorio">*</span>
          </label>
          <input
            type="number"
            id="numero"
            name="numero"
            class="form-input"
            [class.error]="hasFieldError('numero')"
            [(ngModel)]="formData.numero"
            (input)="onFieldChange()"
            required
            min="1"
            max="9999"
            placeholder="1"
            [attr.aria-describedby]="hasFieldError('numero') ? 'numero-error' : null">
          
          <div 
            id="numero-error" 
            class="error-message" 
            *ngIf="hasFieldError('numero')"
            role="alert"
            aria-live="polite">
            {{ getFieldError('numero') }}
          </div>
        </div>

        <!-- Códigos de Rango -->
        <div class="form-row">
          <div class="form-group">
            <label for="codigoInicial" class="form-label">
              Código Inicial
            </label>
            <input
              type="text"
              id="codigoInicial"
              name="codigoInicial"
              class="form-input"
              [class.error]="hasFieldError('codigoInicial')"
              [(ngModel)]="formData.codigoInicial"
              (input)="onFieldChange()"
              pattern="^[A-Za-z]{1,2}\d{2,4}$"
              placeholder="Ej: A100"
              maxlength="6"
              [attr.aria-describedby]="hasFieldError('codigoInicial') ? 'codigoInicial-error' : 'codigoInicial-help'"
              autocomplete="off">
            
            <div id="codigoInicial-help" class="help-text" *ngIf="!hasFieldError('codigoInicial')">
              Formato: 1-2 letras seguidas de 2-4 números (Ej: A100, BC1234)
            </div>
            
            <div 
              id="codigoInicial-error" 
              class="error-message" 
              *ngIf="hasFieldError('codigoInicial')"
              role="alert"
              aria-live="polite">
              {{ getFieldError('codigoInicial') }}
            </div>
          </div>

          <div class="form-group">
            <label for="codigoFinal" class="form-label">
              Código Final
            </label>
            <input
              type="text"
              id="codigoFinal"
              name="codigoFinal"
              class="form-input"
              [class.error]="hasFieldError('codigoFinal')"
              [(ngModel)]="formData.codigoFinal"
              (input)="onFieldChange()"
              pattern="^[A-Za-z]{1,2}\d{2,4}$"
              placeholder="Ej: A199"
              maxlength="6"
              [attr.aria-describedby]="hasFieldError('codigoFinal') ? 'codigoFinal-error' : 'codigoFinal-help'"
              autocomplete="off">
            
            <div id="codigoFinal-help" class="help-text" *ngIf="!hasFieldError('codigoFinal')">
              Debe ser mayor al código inicial
            </div>
            
            <div 
              id="codigoFinal-error" 
              class="error-message" 
              *ngIf="hasFieldError('codigoFinal')"
              role="alert"
              aria-live="polite">
              {{ getFieldError('codigoFinal') }}
            </div>
          </div>
        </div>

        <!-- Estado -->
        <div class="form-group">
          <label for="estado" class="form-label">
            Estado
            <span class="required" aria-label="Campo obligatorio">*</span>
          </label>
          <select
            id="estado"
            name="estado"
            class="form-select"
            [(ngModel)]="formData.estado"
            (change)="onFieldChange()"
            required
            [attr.aria-describedby]="'estado-help'">
            <option value="Activo">Activo</option>
            <option value="Inactivo">Inactivo</option>
          </select>
          
          <div id="estado-help" class="help-text">
            Los muebles inactivos no aparecerán en las búsquedas
          </div>
        </div>

        <!-- Keyboard Shortcut Hint -->
        <div class="keyboard-hint">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
            <line x1="8" y1="21" x2="16" y2="21"/>
            <line x1="12" y1="17" x2="12" y2="21"/>
          </svg>
          Presiona <kbd>Ctrl</kbd> + <kbd>S</kbd> para guardar manualmente
        </div>

      </form>
    </div>
  </main>
</div>