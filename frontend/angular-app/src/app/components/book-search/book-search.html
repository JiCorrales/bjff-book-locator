<div class="card">
  <div>
    <h1>{{ uiText.title }}</h1>
    <p>{{ uiText.subtitle }}</p>
  </div>
  
  <div class="book-search">
    <div class="book-search-row">
      <div class="input-wrapper">
        <div class="prefix-dropdown" [class.is-open]="prefixDropdownOpen">
          <button
            type="button"
            class="prefix-dropdown__trigger"
            (click)="togglePrefixDropdown($event)"
          >
            <span class="prefix-dropdown__label">{{ selectedPrefixLabel }}</span>
            <span class="prefix-dropdown__chevron" aria-hidden="true"></span>
          </button>
          <ul class="prefix-dropdown__list" *ngIf="prefixDropdownOpen">
            <li
              class="prefix-dropdown__option"
              *ngFor="let prefix of bookPrefixes"
              [class.is-active]="prefix.code === selectedPrefix"
              (click)="selectPrefix(prefix)"
            >
              {{ prefix.code ? prefix.display : uiText.noPrefix }}
            </li>
          </ul>
        </div>
        <label class="sr-only" for="bookCodeInput">{{ uiText.placeholder }}</label>
        <input
          type="text"
          class="book-code-input"
          [placeholder]="uiText.placeholder"
          id="bookCodeInput"
          name="bookCode"
          [(ngModel)]="bookCode"
        >
      </div>
      <button class="search-action" (click)="searchBook()">{{ uiText.searchButton }}</button>
    </div>
    
    <div class="search-meta">
      <div class="search-meta__item">
        <div class="search-meta__label">{{ uiText.codeLabel }}</div>
        <div class="search-meta__value">{{ bookCode || uiText.codeFallback }}</div>
      </div>
    </div>

    <!-- Loading indicator -->
    <div *ngIf="isLoading" class="search-status loading">
      <p>Searching...</p>
    </div>

    <!-- Error message -->
    <div *ngIf="errorMessage && !isLoading" class="search-status error">
      <p>{{ errorMessage }}</p>
    </div>

    <!-- Search results -->
    <div *ngIf="searchResult && !isLoading" class="search-results">
      <h3>Book Found!</h3>
      <div class="result-details">
        <p><strong>Code:</strong> {{ searchResult.code }}</p>
        <p><strong>Location:</strong> {{ searchResult.location.location_text }}</p>
        <p><strong>Module:</strong> {{ searchResult.location.module_name }}</p>
        <p><strong>Unit:</strong> {{ searchResult.location.unit_number }} ({{ searchResult.location.unit_side }})</p>
        <p><strong>Shelf:</strong> {{ searchResult.location.shelf_number }}</p>
      </div>
    </div>
  </div>
</div>

<div class="gallery" *ngIf="shelfImageUrl && !isLoading">
  <h2>{{ uiText.galleryTitle }}</h2>
  <div class="shelf-image-container">
    <img
      [src]="shelfImageUrl"
      [alt]="'Shelf image for ' + (searchResult ? searchResult.location.location_text : '')"
      class="shelf-image"
    />
    <div class="shelf-info">
      <p><strong>{{ searchResult ? searchResult.location.module_name : '' }}</strong></p>
      <p>{{ searchResult ? searchResult.location.location_text : '' }}</p>
    </div>
  </div>
</div>

<div class="gallery" *ngIf="!shelfImageUrl && !isLoading && !searchResult">
  <h2>{{ uiText.galleryTitle }}</h2>
  <div class="image-grid">
    <div class="image-placeholder">
      <span>1</span>
      {{ uiText.galleryFloor }}
    </div>
    <div class="image-placeholder">
      <span>2</span>
      {{ uiText.gallerySection }}
    </div>
    <div class="image-placeholder">
      <span>3</span>
      {{ uiText.galleryShelf }}
    </div>
  </div>
</div>
